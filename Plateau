/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package netwalk;
import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import Outils.Data;

/**
 *
 * @author lvulin
 */
/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */

public class Plateau {
    private Tuile plateau[][];
    private int dimensionL;
    private int dimensionC;
    private int xServeur;
    private int yServeur;

    public Plateau(String nomFichier) {
        //LIRE FICHIER
        try (BufferedReader fichier = new BufferedReader(new FileReader(nomFichier))) {
            String ligne;

            // Nombre de lignes
            ligne = fichier.readLine();
            this.dimensionL = Integer.parseInt(ligne);

            //Nombre de colonnes
            ligne = fichier.readLine();
            this.dimensionC = Integer.parseInt(ligne);

            //Position du Serveur
            ligne = fichier.readLine();
            String champsServeur[] = ligne.split(",");
            this.xServeur = Integer.parseInt(champsServeur[0]);
            this.yServeur = Integer.parseInt(champsServeur[1]);

            //Initialiser le tableau de tuiles
            this.plateau = new Tuile[this.dimensionL][this.dimensionC];
            
            //Lire les données des tuiles et remplir le plateau
            for (int i=0; i<dimensionL;i++){
                ligne = fichier.readLine();
                String champsTuiles[] = ligne.split(";");
                int j =0;
                for(String c : champsTuiles){                    
                    // Création de la tuile
                    this.plateau[i][j] = new Tuile(Integer.parseInt(c)); 
                    j++;
                }
        }

        } catch (IOException | NumberFormatException e) {

            System.err.println("Erreur lors de la lecture ou du parsing du fichier : " + nomFichier);
        }
    }

    //Getters
    public Tuile getTuile(int ligne, int colonne) {
        if (ligne >= 0 && ligne < dimensionL && colonne >= 0 && colonne < dimensionC) {
            return this.plateau[ligne][colonne];
        }
        return null;
    }
    
    public int getDimensionL() { return dimensionL; }
    public int getDimensionC() { return dimensionC; }
    public int getXServeur() { return xServeur; }
    public int getYServeur() { return yServeur; }
    
    
     @Override
    public String toString() {
        //Ligne numéro de colonne
        String str = "  ";
        for (int c=0; c<(this.dimensionC); c++) {
        str+= "   ";
        str += c;
        }
        System.out.println(str);
        // Ligne supérieureString
        str = "  ";
        str += Data.asciiGraphic[6];
        for (int i = 0; i < (this.dimensionL+1); i++) {
            str += Data.asciiGraphic[10]; 
        }
        str += Data.asciiGraphic[12];
        System.out.println(str);
        // Lignes intermédiaires
        for (int i = 0; i < this.dimensionL; i++){
            str = " " ;
            str += i;
            str += Data.asciiGraphic[5];
            for (int k = 0; k< this.dimensionC; k++) {
                str += Data.asciiGraphic[this.plateau[i][k].getCode()];}
            str+=Data.asciiGraphic[5];
            System.out.println(str);}
        
        // Ligne inférieure
        str = "  ";
        str += Data.asciiGraphic[3];
        for (int i = 0; i < (this.dimensionL+1); i++) {
            str += Data.asciiGraphic[10]; 
        }
        str += Data.asciiGraphic[9];
        System.out.println(str);
        return ("Bonne chance :" );
    }
}
