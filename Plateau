/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */
package netwalk;

import java.io.BufferedReader;
import java.io.FileReader;
import java.io.IOException;
import Outils.Data;

/**
 *
 * @author lvulin
 */
/*
 * Click nbfs://nbhost/SystemFileSystem/Templates/Licenses/license-default.txt to change this license
 * Click nbfs://nbhost/SystemFileSystem/Templates/Classes/Class.java to edit this template
 */

public class Plateau {
    private Tuile plateau[][];
    private int dimensionL;
    private int dimensionC;
    private int xServeur;
    private int yServeur;

    public Plateau(String nomFichier) {
        //LIRE FICHIER
        try (BufferedReader fichier = new BufferedReader(new FileReader(nomFichier))) {
            String ligne;

            // Nombre de lignes
            ligne = fichier.readLine();
            this.dimensionL = Integer.parseInt(ligne.trim());

            //Nombre de colonnes
            ligne = fichier.readLine();
            this.dimensionC = Integer.parseInt(ligne.trim());

            //Position du Serveur
            ligne = fichier.readLine();
            String champsServeur[] = ligne.split(",");
            this.xServeur = Integer.parseInt(champsServeur[0].trim());
            this.yServeur = Integer.parseInt(champsServeur[1].trim());

            //Initialiser le tableau de tuiles
            this.plateau = new Tuile[this.dimensionL][this.dimensionC];
            
            //Lire les données des tuiles et remplir le plateau
            int compteurLigne = 0;
            while (compteurLigne < this.dimensionL && (ligne = fichier.readLine()) != null) {
                String champsTuiles[] = ligne.split(",");
                
                for (int colonne = 0; colonne < this.dimensionC && colonne < champsTuiles.length; colonne++) {
                    String typeTuile = champsTuiles[colonne].trim();
                    
                    // Création de la tuile
                    this.plateau[compteurLigne][colonne] = new Tuile(typeTuile); 
                }
                
                compteurLigne++;
            }

        } catch (IOException | NumberFormatException e) {

            System.err.println("Erreur lors de la lecture ou du parsing du fichier : " + nomFichier);
            e.printStackTrace();
        }
    }

   
    public Tuile getTuile(int ligne, int colonne) {
        if (ligne >= 0 && ligne < dimensionL && colonne >= 0 && colonne < dimensionC) {
            return this.plateau[ligne][colonne];
        }
        return null;
    }
    
    public int getDimensionL() { return dimensionL; }
    public int getDimensionC() { return dimensionC; }
    public int getXServeur() { return xServeur; }
    public int getYServeur() { return yServeur; }
    
     @Override
    public String toString() {
       
        
        // Ligne supérieure
        String str = Data.asciiGraphic[6];
        for (int i = 0; i < this.dimensionL; i++) {
            str += Data.asciiGraphic[10]; // Ligne horizontale
        }
        str += Data.asciiGraphic[12]; // Coin supérieur droit
    }
}
